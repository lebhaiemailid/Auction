<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üèè Cricket Auction App</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
    body { background: linear-gradient(135deg, #0a2540, #1a3c5e); color: white; min-height: 100vh; }
    .dashboard { max-width: 800px; margin: 0 auto; padding: 40px 20px; text-align: center; }
    h1 { color: #ff6b35; font-size: 2.5em; margin-bottom: 10px; }
    .subtitle { font-size: 1.2em; margin-bottom: 40px; opacity: 0.9; }
    .screen-links { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin: 40px 0; }
    .screen-link { 
      flex: 1; min-width: 250px; padding: 20px; background: #ff6b35; 
      text-decoration: none; color: white; border-radius: 12px; 
      font-size: 1.3em; font-weight: bold; box-shadow: 0 8px 20px rgba(255,107,53,0.4);
      transition: all 0.3s; 
    }
    .screen-link:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(255,107,53,0.6); }
    .screen-link.admin { background: #4caf50; }
    .screen-link.display { background: #2196f3; font-size: 1.5em; }
    .instructions { background: rgba(255,255,255,0.1); padding: 30px; border-radius: 12px; margin: 20px 0; }
    .hidden { display: none !important; }
    
    /* Screen-specific styles */
    input { padding: 20px; margin: 10px; border: none; border-radius: 12px; font-size: 24px; width: 200px; text-align: center; }
    button { padding: 20px 40px; margin: 10px; border: none; border-radius: 12px; font-size: 20px; background: #ff6b35; color: white; cursor: pointer; }
    button:hover { background: #e55a2b; }
    button.sold-btn { background: #4caf50; }
    button.sold-btn:hover { background: #45a049; }
    
    .auctioneer-panel { max-width: 600px; margin: 100px auto; text-align: center; padding: 40px; background: rgba(255,255,255,0.1); border-radius: 20px; }
    .serial-input { font-size: 4em; background: #ff6b35; color: white; border-radius: 20px; padding: 30px; margin: 20px; width: 150px; }
    
    .display-panel { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #000; text-align: center; font-size: 28px; }
    .display-panel img { width: 350px; height: 450px; border-radius: 20px; box-shadow: 0 30px 60px rgba(255,107,53,0.5); margin: 20px 0; }
    .display-name { color: #ff6b35; font-size: 4em; text-shadow: 3px 3px 6px rgba(0,0,0,0.8); margin-bottom: 20px; }
    .display-role { font-size: 3em; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); margin: 10px 0; }
    .display-base { font-size: 4em; color: #ff6b35; font-weight: bold; text-shadow: 3px 3px 6px rgba(0,0,0,0.8); }
    .display-serial { font-size: 2em; color: #fff; opacity: 0.8; margin-top: 20px; }
    
    .admin-panel { max-width: 1200px; margin: 20px auto; padding: 20px; }
    .form-row { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
    .form-row input, .form-row select { flex: 1; min-width: 120px; padding: 12px; border-radius: 8px; border: none; }
    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #333; }
    th { background: #1a3c5e; }
    td img { width: 60px; height: 70px; object-fit: cover; border-radius: 8px; }
    .sold-row { background: #4caf50 !important; color: #000 !important; }
    .team-select { background: #ff6b35; color: white; padding: 8px; border-radius: 6px; font-weight: bold; }
    
    #password-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 1000; }
    #password-modal.show { display: flex; }
    .back-link { display: inline-block; margin: 20px 0; padding: 15px 30px; background: #ff6b35; color: white; text-decoration: none; border-radius: 12px; }
    footer { margin-top: 40px; opacity: 0.7; font-size: 14px; text-align: center; }
  </style>
</head>
<body>
  <!-- Dashboard (Default) -->
  <div id="dashboard" class="dashboard">
    <h1>üèè Cricket Auction App</h1>
    <p class="subtitle">PMP Winter League | Complete Auction System</p>
    
    <div class="screen-links">
      <a href="?screen=auctioneer" class="screen-link" target="_blank">üíª AUCTIONEER<br>Serial Number Entry</a>
      <a href="?screen=admin" class="screen-link admin" target="_blank">üîê ADMIN PANEL<br>Full Control</a>
      <a href="?screen=display" class="screen-link display" target="_blank">üì∫ DISPLAY SCREEN<br>Big Screen</a>
    </div>
    
    <div class="instructions">
      <h3>üöÄ 3-PC Setup</h3>
      <p><strong>Auctioneer PC:</strong> Enter serial ‚Üí Live display</p>
      <p><strong>Admin PC:</strong> Manage bids, teams, sold status</p>
      <p><strong>Display PC:</strong> Fullscreen projector (F11)</p>
    </div>
    <footer>GitHub Pages | Pune Turf Cricket Auctions</footer>
  </div>

  <!-- Admin Password Modal -->
  <div id="password-modal">
    <div style="background: #1a3c5e; padding: 40px; border-radius: 20px; text-align: center; max-width: 400px;">
      <h2>üîê Admin Access</h2>
      <input type="password" id="admin-pass" placeholder="Enter password" style="width: 250px; padding: 15px;">
      <br><br><button onclick="checkAdmin()" style="padding: 15px 40px; font-size: 18px;">Enter Admin ‚Üí</button>
    </div>
  </div>

  <!-- ADMIN SCREEN - ENHANCED -->
  <div id="admin-screen" class="hidden admin-panel">
    <h1>üîê Complete Auction Control</h1>
    <a href="./" class="back-link">‚Üê Dashboard</a>
    
    <h3>‚ûï Add New Player</h3>
    <div class="form-row">
      <input id="name" placeholder="Player Name">
      <input id="role" placeholder="BAT/BOWL/AR/WK">
      <input id="base-price" type="number" placeholder="Base ‚Çπ">
      <select id="team"><option value="">Select Team</option><option>Hanuman Hitters</option><option>Indra Arrows</option><option>Bhima Busters</option><option>Agni Aces</option><option>Shiva Strikers</option></select>
      <input id="photo-url" placeholder="Photo URL">
      <button onclick="savePlayer()">üíæ Add Player</button>
    </div>
    
    <h3>üìä Auction Control</h3>
    <div class="form-row">
      <input id="sold-team" placeholder="Sold Team">
      <input id="final-bid" type="number" placeholder="Final Bid ‚Çπ">
      <button class="sold-btn" onclick="markSold()">‚úÖ Mark Current SOLD</button>
    </div>
    
    <h3>üìã All Players</h3>
    <table id="player-table">
      <thead><tr><th>ID</th><th>Name</th><th>Role</th><th>Base</th><th>Final Bid</th><th>Team</th><th>Photo</th><th>Status</th><th>Action</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- AUCTIONEER SCREEN -->
  <div id="auctioneer-screen" class="hidden auctioneer-panel">
    <h1>üíª Auctioneer Control</h1>
    <a href="./" class="back-link">‚Üê Dashboard</a>
    
    <div style="margin: 80px 0;">
      <label style="font-size: 2.5em; display: block; margin-bottom: 30px;">Enter Serial Number:</label>
      <input type="number" id="serial-input" class="serial-input" min="1" max="50" placeholder="1">
      <br>
      <button onclick="setSerial()" style="font-size: 28px; padding: 25px 60px; margin-top: 20px;">üì∫ SHOW ON DISPLAY</button>
    </div>
    
    <div id="preview" style="background: rgba(255,107,53,0.2); padding: 20px; border-radius: 12px; margin: 30px 0; display: none;">
      <h3 style="color: #fff;">Preview: Serial <span id="preview-id">-</span></h3>
      <p style="font-size: 24px; color: #fff;" id="preview-name">-</p>
    </div>
    
    <p style="font-size: 20px;">Current Display: Serial <span id="current-serial">0</span></p>
  </div>

  <!-- DISPLAY SCREEN -->
  <div id="display-screen" class="hidden display-panel">
    <h1 id="display-name" class="display-name">PLAYER NAME</h1>
    <img id="display-photo" alt="Player Photo">
    <div class="player-info">
      <p id="display-role" class="display-role">-</p>
      <p id="display-base" class="display-base">‚Çπ0</p>
      <p id="display-serial" class="display-serial">Serial #</p>
    </div>
  </div>

  <script>
    const ADMIN_PASS = 'admin123';
    let players = JSON.parse(localStorage.getItem('players')) || [];
    let currentSerial = parseInt(localStorage.getItem('currentSerial')) || -1;

    function initPlayers() {
      if (players.length === 0) {
        players = [
          {id:1, name:'Rohit Sharma', role:'BAT', basePrice:200, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/ff6b35/ffffff?text=Rohit', sold:false},
          {id:2, name:'Jasprit Bumrah', role:'BOWL', basePrice:250, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/4caf50/ffffff?text=Bumrah', sold:false},
          {id:3, name:'Virat Kohli', role:'BAT', basePrice:180, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/2196f3/ffffff?text=Virat', sold:false},
          {id:4, name:'KL Rahul', role:'WK-BAT', basePrice:150, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/9c27b0/ffffff?text=Rahul', sold:false},
          {id:5, name:'Hardik Pandya', role:'AR', basePrice:160, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/ff9800/ffffff?text=Hardik', sold:false},
          {id:6, name:'Ravindra Jadeja', role:'AR', basePrice:140, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/00bcd4/ffffff?text=Jadeja', sold:false},
          {id:7, name:'Shubman Gill', role:'BAT', basePrice:120, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/8bc34a/ffffff?text=Gill', sold:false},
          {id:8, name:'Yashasvi Jaiswal', role:'BAT', basePrice:110, finalBid:0, team:'', photo:'https://via.placeholder.com/400x500/f44336/ffffff?text=Yashasvi', sold:false}
        ];
        savePlayers();
      }
    }

    function savePlayers() {
      localStorage.setItem('players', JSON.stringify(players));
    }

    function init() {
      initPlayers();
      const urlParams = new URLSearchParams(window.location.search);
      const screen = urlParams.get('screen') || 'dashboard';
      
      document.querySelectorAll('[id$="-screen"], #dashboard').forEach(el => el.classList.add('hidden'));
      
      if (screen === 'dashboard') {
        document.getElementById('dashboard').classList.remove('hidden');
      } else {
        document.getElementById(screen + '-screen').classList.remove('hidden');
        if (screen === 'admin') {
          document.getElementById('password-modal').classList.add('show');
        }
      }
      
      updateDisplay();
      loadPlayersTable();
      updateAuctioneer();
    }

    function checkAdmin() {
      if (document.getElementById('admin-pass').value === ADMIN_PASS) {
        document.getElementById('password-modal').classList.remove('show');
      } else {
        alert('‚ùå Wrong Password!');
      }
    }

    function setSerial() {
      const serial = parseInt(document.getElementById('serial-input').value) - 1;
      if (serial >= 0 && serial < players.length && !players[serial].sold) {
        currentSerial = serial;
        localStorage.setItem('currentSerial', currentSerial);
        updateDisplay();
        updateAuctioneer();
      } else {
        alert('Invalid serial or player already sold!');
      }
    }

    function updateAuctioneer() {
      document.getElementById('current-serial').textContent = currentSerial >= 0 ? currentSerial + 1 : 'None';
      if (currentSerial >= 0 && currentSerial < players.length) {
        const p = players[currentSerial];
        document.getElementById('preview-id').textContent = p.id;
        document.getElementById('preview-name').textContent = p.name;
        document.getElementById('preview').style.display = 'block';
      } else {
        document.getElementById('preview').style.display = 'none';
      }
    }

    function updateDisplay() {
      currentSerial = parseInt(localStorage.getItem('currentSerial')) || -1;
      
      if (currentSerial >= 0 && currentSerial < players.length && !players[currentSerial].sold) {
        const p = players[currentSerial];
        document.getElementById('display-name').textContent = p.name;
        document.getElementById('display-photo').src = p.photo + '?t=' + Date.now();
        document.getElementById('display-role').textContent = p.role;
        document.getElementById('display-base').textContent = `‚Çπ${p.basePrice}L`;
        document.getElementById('display-serial').textContent = `Serial #${p.id}`;
      } else {
        clearDisplay();
      }
    }

    function clearDisplay() {
      document.getElementById('display-name').textContent = 'NO PLAYER SELECTED';
      document.getElementById('display-photo').src = '';
      document.getElementById('display-role').textContent = '-';
      document.getElementById('display-base').textContent = '‚Çπ0';
      document.getElementById('display-serial').textContent = 'Serial #';
    }

    // NEW: Mark player SOLD with final bid & team
    function markSold() {
      if (currentSerial < 0 || currentSerial >= players.length) {
        alert('No player selected!');
        return;
      }
      
      const team = document.getElementById('sold-team').value;
      const finalBid = parseInt(document.getElementById('final-bid').value) || 0;
      
      if (!team) {
        alert('Enter team name!');
        return;
      }
      
      players[currentSerial].sold = true;
      players[currentSerial].team = team;
      players[currentSerial].finalBid = finalBid;
      savePlayers();
      
      // Clear form
      document.getElementById('sold-team').value = '';
      document.getElementById('final-bid').value = '';
      
      loadPlayersTable();
      alert(`‚úÖ ${players[currentSerial].name} SOLD to ${team} for ‚Çπ${finalBid}L!`);
      
      // Move to next unsold player
      let nextIdx = (currentSerial + 1) % players.length;
      while (nextIdx !== currentSerial && players[nextIdx]?.sold) {
        nextIdx = (nextIdx + 1) % players.length;
      }
      currentSerial = nextIdx;
      localStorage.setItem('currentSerial', currentSerial);
      updateDisplay();
      updateAuctioneer();
    }

    function savePlayer() {
      const data = {
        name: document.getElementById('name').value,
        role: document.getElementById('role').value,
        basePrice: parseInt(document.getElementById('base-price').value) || 0,
        team: document.getElementById('team').value,
        photo: document.getElementById('photo-url').value || 'https://via.placeholder.com/400x500/cccccc/000000?text=No+Photo',
        finalBid: 0,
        sold: false
      };
      
      if (!data.name) return alert('Name required!');
      
      const newPlayer = { id: players.length + 1, ...data };
      players.push(newPlayer);
      savePlayers();
      loadPlayersTable();
      alert('‚úÖ Player Added!');
      
      document.getElementById('name').value = '';
      document.getElementById('role').value = '';
      document.getElementById('base-price').value = '';
      document.getElementById('team').value = '';
      document.getElementById('photo-url').value = '';
    }

    function loadPlayersTable() {
      const tbody = document.querySelector('#player-table tbody');
      if (!tbody) return;
      
      tbody.innerHTML = '';
      players.forEach((p, i) => {
        const row = tbody.insertRow();
        row.className = p.sold ? 'sold-row' : '';
        row.innerHTML = `
          <td>${p.id}</td>
          <td>${p.name}</td>
          <td>${p.role}</td>
          <td>‚Çπ${p.basePrice}L</td>
          <td>${p.finalBid ? '‚Çπ' + p.finalBid + 'L' : '-'}</td>
          <td>${p.team ? `<span class="team-select">${p.team}</span>` : '-'}</td>
          <td><img src="${p.photo}" onerror="this.src='https://via.placeholder.com/60x70/ccc/000?text=?';"></td>
          <td style="font-weight: bold;">${p.sold ? '‚úÖ SOLD' : '‚è≥ UNSOLD'}</td>
          <td>${!p.sold ? `<button class="sold-btn" onclick="markSoldFromRow(${i})" style="padding: 5px 10px; font-size: 12px;">Sell Now</button>` : 'Sold'}</td>
        `;
      });
    }

    // Sell from table row
    function markSoldFromRow(index) {
      currentSerial = index;
      localStorage.setItem('currentSerial', currentSerial);
      document.getElementById('sold-team').focus();
      alert(`Select Serial ${index + 1} & mark SOLD from top controls`);
    }

    document.addEventListener('DOMContentLoaded', () => {
      const serialInput = document.getElementById('serial-input');
      if (serialInput) {
        serialInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') setSerial();
        });
      }
    });

    setInterval(() => {
      updateDisplay();
      if (document.getElementById('auctioneer-screen') && !document.getElementById('auctioneer-screen').classList.contains('hidden')) {
        updateAuctioneer();
      }
    }, 500);
    
    init();
  </script>
</body>
</html>
